<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FAZ STORE ‚Äî Admin Panel</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --primary: #1E4D8C;
    --primary-light: #3B82C4;
    --accent: #7BB8F0;
    --sky: #EBF4FF;
    --dark: #0D2545;
    --border: #D6E8FA;
    --text: #0D2545;
    --text-muted: #7A9EC4;
    --bg: #F0F6FF;
    --white: #fff;
    --green: #10B981;
    --red: #EF4444;
    --yellow: #F59E0B;
    --shadow: 0 4px 24px rgba(30,77,140,0.08);
    --shadow-hover: 0 8px 32px rgba(30,77,140,0.14);
  }

  * { margin:0; padding:0; box-sizing:border-box; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    display: flex;
  }

  /* ‚îÄ‚îÄ SIDEBAR ‚îÄ‚îÄ */
  .sidebar {
    width: 240px;
    background: var(--dark);
    min-height: 100vh;
    position: fixed;
    left: 0; top: 0; bottom: 0;
    display: flex;
    flex-direction: column;
    z-index: 50;
    transition: transform 0.3s;
  }

  .sidebar-logo {
    padding: 24px 20px;
    border-bottom: 1px solid rgba(255,255,255,0.08);
    display: flex; align-items: center; gap: 12px;
  }
  .sidebar-logo-icon {
    width: 38px; height: 38px;
    background: var(--primary-light);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-weight: 700; font-size: 14px; color: white;
    letter-spacing: -0.5px;
    overflow: hidden; flex-shrink: 0;
    border: 2px solid rgba(123,184,240,0.5);
  }
  .sidebar-logo-icon img { width:100%; height:100%; object-fit:cover; }
  .sidebar-logo-text { line-height: 1.15; }
  .sidebar-logo-name {
    font-size: 15px; font-weight: 700; color: white;
  }
  .sidebar-logo-name span { color: var(--accent); }
  .sidebar-logo-sub {
    font-size: 9px; color: rgba(255,255,255,0.35);
    text-transform: uppercase; letter-spacing: 1.5px; font-weight: 500;
  }

  .sidebar-nav {
    padding: 16px 12px;
    flex: 1;
    display: flex; flex-direction: column; gap: 4px;
  }

  .sidebar-label {
    font-size: 9px; font-weight: 600; color: rgba(255,255,255,0.25);
    text-transform: uppercase; letter-spacing: 1.5px;
    padding: 12px 8px 6px;
  }

  .sidebar-item {
    display: flex; align-items: center; gap: 10px;
    padding: 10px 12px;
    border-radius: 10px;
    color: rgba(255,255,255,0.55);
    font-size: 13px; font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    border: none; background: none;
    width: 100%; text-align: left;
    font-family: 'DM Sans', sans-serif;
  }
  .sidebar-item:hover { background: rgba(255,255,255,0.07); color: white; }
  .sidebar-item.active { background: var(--primary); color: white; }
  .sidebar-item svg { width: 16px; height: 16px; flex-shrink: 0; opacity: 0.8; }
  .sidebar-item.active svg { opacity: 1; }

  .sidebar-footer {
    padding: 16px 12px;
    border-top: 1px solid rgba(255,255,255,0.08);
  }
  .sidebar-user {
    display: flex; align-items: center; gap: 10px;
    padding: 10px 12px;
  }
  .sidebar-avatar {
    width: 32px; height: 32px;
    background: var(--primary-light);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 13px; font-weight: 700; color: white;
  }
  .sidebar-user-name { font-size: 13px; color: rgba(255,255,255,0.7); font-weight: 500; }
  .sidebar-user-role { font-size: 10px; color: rgba(255,255,255,0.3); }

  /* ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ */
  .main {
    margin-left: 240px;
    flex: 1;
    display: flex; flex-direction: column;
    min-height: 100vh;
  }

  /* ‚îÄ‚îÄ TOPBAR ‚îÄ‚îÄ */
  .topbar {
    background: white;
    border-bottom: 1px solid var(--border);
    padding: 0 32px;
    height: 64px;
    display: flex; align-items: center; justify-content: space-between;
    position: sticky; top: 0; z-index: 40;
    box-shadow: 0 1px 8px rgba(30,77,140,0.06);
  }
  .topbar-title {
    font-size: 18px; font-weight: 700; color: var(--text);
    letter-spacing: -0.3px;
  }
  .topbar-title span { color: var(--text-muted); font-weight: 400; font-size: 14px; margin-left: 8px; }
  .topbar-right { display: flex; align-items: center; gap: 12px; }

  .btn {
    display: inline-flex; align-items: center; gap: 7px;
    padding: 9px 18px;
    border-radius: 10px;
    font-size: 13px; font-weight: 600;
    cursor: pointer;
    font-family: 'DM Sans', sans-serif;
    transition: all 0.2s;
    border: none;
  }
  .btn svg { width: 15px; height: 15px; }
  .btn-primary { background: var(--primary); color: white; }
  .btn-primary:hover { background: var(--dark); }
  .btn-outline { background: white; color: var(--primary); border: 1.5px solid var(--border); }
  .btn-outline:hover { border-color: var(--primary); background: var(--sky); }
  .btn-danger { background: #FEF2F2; color: var(--red); border: 1.5px solid #FCA5A5; }
  .btn-danger:hover { background: var(--red); color: white; }
  .btn-success { background: #ECFDF5; color: var(--green); border: 1.5px solid #6EE7B7; }
  .btn-success:hover { background: var(--green); color: white; }
  .btn-sm { padding: 6px 12px; font-size: 12px; }

  /* ‚îÄ‚îÄ CONTENT ‚îÄ‚îÄ */
  .content { padding: 28px 32px; flex: 1; }

  /* ‚îÄ‚îÄ STATS ROW ‚îÄ‚îÄ */
  .stats-row {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 16px;
    margin-bottom: 28px;
  }
  .stat-card {
    background: white;
    border-radius: 14px;
    padding: 20px;
    box-shadow: var(--shadow);
    display: flex; align-items: center; gap: 14px;
    border: 1px solid var(--border);
  }
  .stat-icon {
    width: 44px; height: 44px;
    border-radius: 12px;
    display: flex; align-items: center; justify-content: center;
    font-size: 20px;
    flex-shrink: 0;
  }
  .stat-icon.blue { background: var(--sky); }
  .stat-icon.green { background: #ECFDF5; }
  .stat-icon.yellow { background: #FFFBEB; }
  .stat-icon.purple { background: #F5F3FF; }
  .stat-info {}
  .stat-val { font-size: 22px; font-weight: 700; color: var(--text); line-height: 1; }
  .stat-lbl { font-size: 12px; color: var(--text-muted); margin-top: 3px; }

  /* ‚îÄ‚îÄ TABLE SECTION ‚îÄ‚îÄ */
  .section-card {
    background: white;
    border-radius: 16px;
    box-shadow: var(--shadow);
    border: 1px solid var(--border);
    overflow: hidden;
  }
  .section-head {
    padding: 20px 24px;
    border-bottom: 1px solid var(--border);
    display: flex; align-items: center; justify-content: space-between;
    gap: 12px;
  }
  .section-head-left { display: flex; align-items: center; gap: 12px; }
  .section-head-title { font-size: 15px; font-weight: 700; color: var(--text); }

  .search-input {
    padding: 8px 14px 8px 36px;
    border: 1.5px solid var(--border);
    border-radius: 9px;
    font-size: 13px;
    font-family: 'DM Sans', sans-serif;
    color: var(--text);
    outline: none;
    width: 200px;
    background: var(--bg);
    transition: border-color 0.2s;
  }
  .search-input:focus { border-color: var(--primary-light); }
  .search-wrap { position: relative; }
  .search-wrap svg {
    position: absolute; left: 10px; top: 50%;
    transform: translateY(-50%);
    color: var(--text-muted); width: 14px; height: 14px;
    pointer-events: none;
  }

  /* ‚îÄ‚îÄ TABLE ‚îÄ‚îÄ */
  .table-wrap { overflow-x: auto; }
  table { width: 100%; border-collapse: collapse; }
  thead th {
    padding: 11px 16px;
    text-align: left;
    font-size: 11px; font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase; letter-spacing: 0.8px;
    background: var(--bg);
    border-bottom: 1px solid var(--border);
    white-space: nowrap;
  }
  tbody tr {
    border-bottom: 1px solid #F0F6FF;
    transition: background 0.15s;
  }
  tbody tr:last-child { border-bottom: none; }
  tbody tr:hover { background: #F8FBFF; }
  tbody td {
    padding: 13px 16px;
    font-size: 13px; color: var(--text);
    vertical-align: middle;
  }

  .prod-cell { display: flex; align-items: center; gap: 10px; }
  .prod-emoji {
    width: 36px; height: 36px;
    background: var(--sky);
    border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
    font-size: 18px; flex-shrink: 0;
  }
  .prod-name { font-weight: 600; font-size: 13px; }
  .prod-id { font-size: 11px; color: var(--text-muted); }

  .badge {
    display: inline-flex; align-items: center;
    padding: 3px 9px; border-radius: 100px;
    font-size: 10px; font-weight: 700;
    text-transform: uppercase; letter-spacing: 0.5px;
  }
  .badge-blue { background: var(--sky); color: var(--primary); }
  .badge-green { background: #ECFDF5; color: #065F46; }
  .badge-yellow { background: #FFFBEB; color: #92400E; }
  .badge-red { background: #FEF2F2; color: #991B1B; }
  .badge-gray { background: #F3F4F6; color: #6B7280; }

  .price-text { font-weight: 700; color: var(--primary); }

  .actions { display: flex; gap: 6px; }

  /* ‚îÄ‚îÄ EMPTY STATE ‚îÄ‚îÄ */
  .empty-state {
    text-align: center; padding: 60px 20px;
    color: var(--text-muted);
  }
  .empty-state .empty-icon { font-size: 48px; margin-bottom: 12px; }
  .empty-state p { font-size: 14px; }

  /* ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ */
  .modal-overlay {
    display: none;
    position: fixed; inset: 0;
    background: rgba(10,20,40,0.5);
    backdrop-filter: blur(5px);
    z-index: 200;
    align-items: center; justify-content: center;
    padding: 20px;
  }
  .modal-overlay.open { display: flex; }

  .modal {
    background: white;
    border-radius: 20px;
    width: 100%; max-width: 600px;
    max-height: 90vh;
    overflow-y: auto;
    animation: modalIn 0.28s cubic-bezier(0.34,1.56,0.64,1);
    box-shadow: 0 24px 80px rgba(13,37,69,0.25);
  }
  @keyframes modalIn {
    from { transform: scale(0.9) translateY(16px); opacity: 0; }
    to   { transform: scale(1) translateY(0); opacity: 1; }
  }

  .modal-head {
    padding: 20px 24px;
    border-bottom: 1px solid var(--border);
    display: flex; align-items: center; justify-content: space-between;
  }
  .modal-head-title { font-size: 16px; font-weight: 700; color: var(--text); }
  .modal-close {
    width: 32px; height: 32px;
    border-radius: 8px;
    border: 1.5px solid var(--border);
    background: none; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    color: var(--text-muted); font-size: 18px; line-height: 1;
    transition: all 0.2s;
  }
  .modal-close:hover { background: #FEF2F2; color: var(--red); border-color: #FCA5A5; }

  .modal-body { padding: 24px; }

  /* ‚îÄ‚îÄ FORM ‚îÄ‚îÄ */
  .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
  .form-group { display: flex; flex-direction: column; gap: 6px; }
  .form-group.full { grid-column: 1 / -1; }
  .form-label {
    font-size: 12px; font-weight: 600;
    color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.6px;
  }
  .form-input, .form-select, .form-textarea {
    padding: 10px 13px;
    border: 1.5px solid var(--border);
    border-radius: 10px;
    font-size: 13px;
    font-family: 'DM Sans', sans-serif;
    color: var(--text);
    outline: none;
    background: white;
    transition: border-color 0.2s;
    width: 100%;
  }
  .form-input:focus, .form-select:focus, .form-textarea:focus {
    border-color: var(--primary-light);
    box-shadow: 0 0 0 3px rgba(59,130,196,0.08);
  }
  .form-textarea { resize: vertical; min-height: 70px; }

  /* ‚îÄ‚îÄ IMAGE UPLOAD ‚îÄ‚îÄ */
  .img-upload-area {
    border: 2px dashed var(--border);
    border-radius: 14px;
    padding: 16px;
    display: flex; align-items: center; gap: 16px;
    transition: all 0.2s;
    background: var(--bg);
    position: relative;
  }
  .img-upload-area:hover { border-color: var(--primary-light); background: var(--sky); }
  .img-upload-area.has-image { border-style: solid; border-color: var(--primary-light); background: white; }

  .img-preview-box {
    width: 80px; height: 80px;
    border-radius: 12px;
    overflow: hidden;
    background: #e8f0fb;
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0;
    font-size: 32px;
    border: 1.5px solid var(--border);
  }
  .img-preview-box img { width:100%; height:100%; object-fit:cover; }

  .img-upload-info { flex: 1; }
  .img-upload-title { font-size: 13px; font-weight: 600; color: var(--text); margin-bottom: 3px; }
  .img-upload-sub { font-size: 11px; color: var(--text-muted); line-height: 1.5; }

  .img-upload-btn {
    display: inline-flex; align-items: center; gap: 6px;
    padding: 8px 14px;
    background: var(--primary); color: white;
    border-radius: 9px; font-size: 12px; font-weight: 600;
    cursor: pointer; border: none;
    font-family: 'DM Sans', sans-serif;
    transition: background 0.2s; flex-shrink: 0;
  }
  .img-upload-btn:hover { background: var(--dark); }

  .img-remove-btn {
    position: absolute; top: 8px; right: 8px;
    width: 24px; height: 24px;
    background: #FEF2F2; color: var(--red);
    border: 1px solid #FCA5A5; border-radius: 50%;
    font-size: 13px; cursor: pointer;
    display: none; align-items: center; justify-content: center;
    transition: all 0.2s; line-height: 1;
  }
  .img-remove-btn:hover { background: var(--red); color: white; }
  .img-upload-area.has-image .img-remove-btn { display: flex; }

  .tags-wrap { display: flex; flex-wrap: wrap; gap: 6px; }
  .tag-check {
    display: flex; align-items: center; gap: 5px;
    padding: 6px 12px;
    border: 1.5px solid var(--border);
    border-radius: 100px;
    font-size: 12px; font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    user-select: none;
    color: var(--text-muted);
  }
  .tag-check.selected { border-color: var(--primary); background: var(--sky); color: var(--primary); }
  .tag-check input { display: none; }

  /* Package list */
  .package-list { display: flex; flex-direction: column; gap: 12px; margin-bottom: 12px; }
  .package-item {
    border: 1.5px solid var(--border);
    border-radius: 12px;
    padding: 14px;
    position: relative;
    background: var(--bg);
  }
  .package-item-head {
    display: flex; align-items: center; justify-content: space-between;
    margin-bottom: 10px;
  }
  .package-item-title { font-size: 12px; font-weight: 700; color: var(--primary); text-transform: uppercase; letter-spacing: 0.5px; }
  .btn-remove-pkg {
    width: 24px; height: 24px;
    border-radius: 6px; border: none;
    background: #FEF2F2; color: var(--red);
    font-size: 14px; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
  }
  .btn-remove-pkg:hover { background: var(--red); color: white; }
  .pkg-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px; }
  .feature-list { display: flex; flex-direction: column; gap: 4px; }
  .feature-row { display: flex; gap: 6px; align-items: center; }
  .feature-row input {
    flex: 1; padding: 7px 10px; border: 1.5px solid var(--border);
    border-radius: 8px; font-size: 12px;
    font-family: 'DM Sans', sans-serif;
    outline: none; color: var(--text);
    transition: border-color 0.2s;
  }
  .feature-row input:focus { border-color: var(--primary-light); }
  .btn-remove-feat {
    width: 24px; height: 24px; border-radius: 6px; border: none;
    background: #FEF2F2; color: var(--red);
    font-size: 14px; cursor: pointer; flex-shrink: 0;
    display: flex; align-items: center; justify-content: center;
  }
  .btn-remove-feat:hover { background: var(--red); color: white; }
  .btn-add-feat {
    font-size: 11px; font-weight: 600; color: var(--primary-light);
    border: none; background: none; cursor: pointer;
    font-family: 'DM Sans', sans-serif;
    padding: 2px 0; margin-top: 2px;
    display: flex; align-items: center; gap: 4px;
  }
  .btn-add-feat:hover { color: var(--primary); }

  .form-footer {
    display: flex; justify-content: flex-end; gap: 10px;
    padding: 16px 24px;
    border-top: 1px solid var(--border);
  }

  /* ‚îÄ‚îÄ DELETE CONFIRM ‚îÄ‚îÄ */
  .confirm-modal {
    background: white;
    border-radius: 16px;
    width: 100%; max-width: 380px;
    padding: 28px;
    text-align: center;
    animation: modalIn 0.25s cubic-bezier(0.34,1.56,0.64,1);
    box-shadow: 0 24px 60px rgba(13,37,69,0.2);
  }
  .confirm-icon { font-size: 40px; margin-bottom: 12px; }
  .confirm-title { font-size: 17px; font-weight: 700; margin-bottom: 8px; }
  .confirm-msg { font-size: 13px; color: var(--text-muted); line-height: 1.5; margin-bottom: 20px; }
  .confirm-btns { display: flex; gap: 10px; }
  .confirm-btns .btn { flex: 1; justify-content: center; }

  /* ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ */
  .toast {
    position: fixed; bottom: 24px; right: 24px;
    background: var(--dark); color: white;
    padding: 13px 18px; border-radius: 12px;
    font-size: 13px; font-weight: 500;
    box-shadow: 0 8px 30px rgba(0,0,0,0.18);
    transform: translateY(80px); opacity: 0;
    transition: all 0.35s cubic-bezier(0.34,1.56,0.64,1);
    z-index: 300;
    display: flex; align-items: center; gap: 9px;
    border-left: 3px solid var(--primary-light);
    max-width: 320px;
  }
  .toast.show { transform: translateY(0); opacity: 1; }
  .toast.success { border-left-color: var(--green); }
  .toast.error { border-left-color: var(--red); }

  /* ‚îÄ‚îÄ LOGO MODAL ‚îÄ‚îÄ */
  .logo-modal-preview {
    width: 100px; height: 100px;
    border-radius: 50%;
    overflow: hidden;
    margin: 0 auto 20px;
    border: 3px solid var(--border);
    background: var(--sky);
    display: flex; align-items: center; justify-content: center;
    font-size: 32px; font-weight: 700; color: var(--primary);
    box-shadow: 0 4px 20px rgba(30,77,140,0.15);
  }
  .logo-modal-preview img { width:100%; height:100%; object-fit:cover; }

  /* ‚îÄ‚îÄ SCROLLBAR ‚îÄ‚îÄ */
  ::-webkit-scrollbar { width: 5px; height: 5px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 10px; }

  /* ‚îÄ‚îÄ PASSWORD GATE ‚îÄ‚îÄ */
  .gate-overlay {
    position: fixed; inset: 0; z-index: 999;
    background: linear-gradient(135deg, #0D2545 0%, #163A6B 50%, #1E4D8C 100%);
    display: flex; align-items: center; justify-content: center;
    padding: 20px;
  }
  .gate-overlay.hidden { display: none; }

  .gate-overlay::before {
    content: '';
    position: absolute; top: -20%; left: 50%;
    transform: translateX(-50%);
    width: 700px; height: 500px;
    background: radial-gradient(ellipse, rgba(123,184,240,0.15) 0%, transparent 65%);
    pointer-events: none;
  }

  .gate-card {
    background: white;
    border-radius: 24px;
    padding: 44px 40px;
    width: 100%; max-width: 420px;
    text-align: center;
    position: relative;
    box-shadow: 0 40px 100px rgba(13,37,69,0.4);
    animation: gateIn 0.5s cubic-bezier(0.34,1.56,0.64,1);
  }
  @keyframes gateIn {
    from { transform: scale(0.85) translateY(24px); opacity: 0; }
    to   { transform: scale(1) translateY(0); opacity: 1; }
  }

  .gate-logo {
    width: 64px; height: 64px;
    background: var(--primary);
    border-radius: 18px;
    display: flex; align-items: center; justify-content: center;
    font-size: 22px; font-weight: 700; color: white;
    margin: 0 auto 20px;
    box-shadow: 0 8px 24px rgba(30,77,140,0.3);
  }

  .gate-title {
    font-size: 22px; font-weight: 700; color: var(--text);
    margin-bottom: 6px; letter-spacing: -0.3px;
  }
  .gate-sub {
    font-size: 13px; color: var(--text-muted); margin-bottom: 28px; line-height: 1.5;
  }

  .gate-input-wrap {
    position: relative; margin-bottom: 14px;
  }
  .gate-input {
    width: 100%; padding: 13px 46px 13px 16px;
    border: 2px solid var(--border);
    border-radius: 12px;
    font-size: 15px; font-family: 'DM Sans', sans-serif;
    color: var(--text); outline: none;
    transition: border-color 0.2s, box-shadow 0.2s;
    letter-spacing: 3px;
    text-align: center;
  }
  .gate-input:focus {
    border-color: var(--primary-light);
    box-shadow: 0 0 0 4px rgba(59,130,196,0.1);
  }
  .gate-input.shake {
    animation: shake 0.4s ease;
    border-color: var(--red);
  }
  @keyframes shake {
    0%,100% { transform: translateX(0); }
    20%      { transform: translateX(-8px); }
    40%      { transform: translateX(8px); }
    60%      { transform: translateX(-6px); }
    80%      { transform: translateX(6px); }
  }

  .gate-eye {
    position: absolute; right: 14px; top: 50%;
    transform: translateY(-50%);
    cursor: pointer; color: var(--text-muted);
    background: none; border: none;
    display: flex; align-items: center;
    transition: color 0.2s;
  }
  .gate-eye:hover { color: var(--primary); }

  .gate-btn {
    width: 100%; padding: 13px;
    background: var(--primary); color: white;
    border: none; border-radius: 12px;
    font-size: 14px; font-weight: 700;
    font-family: 'DM Sans', sans-serif;
    cursor: pointer; letter-spacing: 0.3px;
    transition: all 0.2s;
  }
  .gate-btn:hover { background: var(--dark); transform: translateY(-1px); }
  .gate-btn:active { transform: translateY(0); }

  .gate-error {
    font-size: 12px; color: var(--red);
    margin-bottom: 12px; min-height: 18px;
    font-weight: 600;
  }

  .gate-attempts {
    font-size: 11px; color: var(--text-muted);
    margin-top: 16px;
  }
  .gate-attempts span { color: var(--red); font-weight: 700; }

  .gate-dots {
    display: flex; justify-content: center; gap: 8px;
    margin-bottom: 20px;
  }
  .gate-dot {
    width: 10px; height: 10px;
    border-radius: 50%;
    background: var(--border);
    transition: background 0.2s, transform 0.2s;
  }
  .gate-dot.filled { background: var(--primary); transform: scale(1.2); }

  /* locked state */
  .gate-locked { text-align: center; padding: 10px 0; }
  .gate-lock-icon { font-size: 40px; margin-bottom: 12px; }
  .gate-lock-msg { font-size: 14px; color: var(--text-muted); line-height: 1.6; }
  .gate-countdown { font-size: 28px; font-weight: 700; color: var(--red); margin: 12px 0; }

  /* body blur when gate is open */
  .body-content { transition: filter 0.3s; }
  .body-content.blurred { filter: blur(8px); pointer-events: none; }

  /* logout btn in sidebar */
  .btn-logout {
    width: 100%;
    display: flex; align-items: center; gap: 10px;
    padding: 10px 12px;
    border-radius: 10px;
    background: rgba(239,68,68,0.08);
    border: 1px solid rgba(239,68,68,0.15);
    color: #FC8181;
    font-size: 13px; font-weight: 600;
    cursor: pointer;
    font-family: 'DM Sans', sans-serif;
    transition: all 0.2s;
  }
  .btn-logout:hover { background: rgba(239,68,68,0.18); color: #FCA5A5; }
  .btn-logout svg { width: 15px; height: 15px; }
</style>
</head>
<body>

<!-- PASSWORD GATE -->
<div class="gate-overlay" id="gateOverlay">
  <div class="gate-card">
    <div class="gate-logo">FS</div>
    <div class="gate-title">FAZ STORE Admin</div>
    <div class="gate-sub">Masukkan kata sandi untuk mengakses panel admin</div>

    <div id="gateNormal">
      <div class="gate-dots" id="gateDots">
        <div class="gate-dot" id="dot0"></div>
        <div class="gate-dot" id="dot1"></div>
        <div class="gate-dot" id="dot2"></div>
        <div class="gate-dot" id="dot3"></div>
      </div>
      <div class="gate-input-wrap">
        <input class="gate-input" id="gateInput" type="password" maxlength="20"
          placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
          oninput="updateDots()"
          onkeydown="if(event.key==='Enter') checkPassword()">
        <button class="gate-eye" id="gateEyeBtn" onclick="toggleGateEye()">
          <svg id="gateEyeIcon" width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
          </svg>
        </button>
      </div>
      <div class="gate-error" id="gateError"></div>
      <button class="gate-btn" onclick="checkPassword()">Masuk ke Panel Admin</button>
      <div class="gate-attempts" id="gateAttempts"></div>
    </div>

    <div id="gateLocked" class="gate-locked" style="display:none;">
      <div class="gate-lock-icon">üîí</div>
      <div style="font-size:17px;font-weight:700;color:var(--text);margin-bottom:8px;">Akses Dikunci!</div>
      <div class="gate-lock-msg">Terlalu banyak percobaan salah.<br>Coba lagi dalam</div>
      <div class="gate-countdown" id="gateCountdown">30</div>
      <div class="gate-lock-msg">detik</div>
    </div>
  </div>
</div>

<!-- BODY CONTENT WRAPPER -->
<div class="body-content" id="bodyContent">

<!-- SIDEBAR -->
<aside class="sidebar">
  <div class="sidebar-logo">
    <div class="sidebar-logo-icon">FS</div>
    <div class="sidebar-logo-text">
      <div class="sidebar-logo-name">FAZ <span>STORE</span></div>
      <div class="sidebar-logo-sub">Admin Panel</div>
    </div>
  </div>

  <nav class="sidebar-nav">
    <div class="sidebar-label">Menu</div>
    <button class="sidebar-item active" onclick="setPage('products')">
      <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/></svg>
      Kelola Produk
    </button>
    <button class="sidebar-item" onclick="setPage('add')">
      <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
      Tambah Produk
    </button>

    <div class="sidebar-label" style="margin-top:8px">Info</div>
    <button class="sidebar-item" onclick="openLogoModal()">
      <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
      Ganti Logo
    </button>
    <button class="sidebar-item" onclick="goToStore()">
      <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg>
      Lihat Toko
    </button>
  </nav>

  <div class="sidebar-footer">
    <div class="sidebar-user">
      <div class="sidebar-avatar">F</div>
      <div>
        <div class="sidebar-user-name">Admin Faz</div>
        <div class="sidebar-user-role">Super Admin</div>
      </div>
    </div>
    <button class="btn-logout" onclick="logout()">
      <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/></svg>
      Keluar / Logout
    </button>
  </div>
</aside>

<!-- MAIN -->
<div class="main">

  <!-- TOPBAR -->
  <div class="topbar">
    <div class="topbar-title" id="topbarTitle">Kelola Produk <span>/ Dashboard</span></div>
    <div class="topbar-right">
      <button class="btn btn-primary" onclick="openAddModal()">
        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
        Tambah Produk
      </button>
    </div>
  </div>

  <!-- CONTENT -->
  <div class="content">

    <!-- STATS -->
    <div class="stats-row">
      <div class="stat-card">
        <div class="stat-icon blue">üì¶</div>
        <div class="stat-info">
          <div class="stat-val" id="statTotal">0</div>
          <div class="stat-lbl">Total Produk</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon yellow">üî•</div>
        <div class="stat-info">
          <div class="stat-val" id="statPopuler">0</div>
          <div class="stat-lbl">Produk Populer</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon green">‚ú®</div>
        <div class="stat-info">
          <div class="stat-val" id="statNew">0</div>
          <div class="stat-lbl">Produk Baru</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon purple">üèÜ</div>
        <div class="stat-info">
          <div class="stat-val" id="statBest">0</div>
          <div class="stat-lbl">Best Seller</div>
        </div>
      </div>
    </div>

    <!-- PRODUCT TABLE -->
    <div class="section-card">
      <div class="section-head">
        <div class="section-head-left">
          <div class="section-head-title">Daftar Produk</div>
          <div class="search-wrap">
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
            <input class="search-input" type="text" placeholder="Cari produk..." oninput="renderTable(this.value)">
          </div>
        </div>
        <div style="display:flex;gap:8px;align-items:center;">
          <select class="form-select" style="width:140px;padding:8px 12px;font-size:12px;" onchange="filterTable(this.value)">
            <option value="all">Semua Kategori</option>
            <option value="populer">Populer</option>
            <option value="new">New</option>
            <option value="editing">Editing</option>
            <option value="movie">Movie</option>
            <option value="music">Music</option>
          </select>
        </div>
      </div>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>Produk</th>
              <th>Kategori</th>
              <th>Badge</th>
              <th>Harga</th>
              <th>Paket</th>
              <th>Aksi</th>
            </tr>
          </thead>
          <tbody id="productTableBody"></tbody>
        </table>
      </div>
    </div>

  </div>
</div>

</div><!-- end body-content -->

<!-- LOGO MODAL -->
<div class="modal-overlay" id="logoModalOverlay">
  <div class="modal" style="max-width:420px;">
    <div class="modal-head">
      <div class="modal-head-title">üñºÔ∏è Ganti Logo Toko</div>
      <button class="modal-close" onclick="closeLogoModal()">√ó</button>
    </div>
    <div class="modal-body" style="text-align:center;">
      <div class="logo-modal-preview" id="logoPreview">FS</div>
      <p style="font-size:13px;color:var(--text-muted);margin-bottom:20px;line-height:1.6;">
        Upload foto logo kamu (disarankan foto 1√ó1 / kotak).<br>
        Logo akan otomatis muncul di navbar dan footer toko.
      </p>

      <div class="img-upload-area" id="logoUploadArea" style="margin-bottom:16px;">
        <div class="img-upload-info">
          <div class="img-upload-title">Pilih foto logo</div>
          <div class="img-upload-sub">JPG, PNG, WEBP ¬∑ Maks 3MB ¬∑ Rasio 1√ó1</div>
        </div>
        <label class="img-upload-btn">
          <svg width="13" height="13" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/></svg>
          Pilih Foto
          <input type="file" id="logoFileInput" accept="image/*" style="display:none" onchange="handleLogoUpload(event)">
        </label>
      </div>
      <div id="logoStatus" style="font-size:12px;color:var(--text-muted);margin-bottom:4px;min-height:18px;"></div>
    </div>
    <div class="form-footer">
      <button class="btn btn-outline" onclick="resetLogo()">Reset Default</button>
      <button class="btn btn-danger" onclick="closeLogoModal()">Batal</button>
      <button class="btn btn-primary" id="logoSaveBtn" onclick="saveLogo()" disabled>
        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" width="14" height="14"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
        Simpan Logo
      </button>
    </div>
  </div>
</div>

<!-- ADD / EDIT MODAL -->
<div class="modal-overlay" id="modalOverlay">
  <div class="modal">
    <div class="modal-head">
      <div class="modal-head-title" id="modalTitle">Tambah Produk Baru</div>
      <button class="modal-close" onclick="closeModal()">√ó</button>
    </div>
    <div class="modal-body">
      <div class="form-grid">

        <div class="form-group">
          <label class="form-label">Nama Produk</label>
          <input class="form-input" id="fName" placeholder="cth: Netflix" />
        </div>

        <div class="form-group">
          <label class="form-label">Harga Mulai Dari</label>
          <input class="form-input" id="fPrice" placeholder="cth: Rp 10.000" />
        </div>

        <div class="form-group full">
          <label class="form-label">Foto Produk (1√ó1 / Square)</label>
          <div class="img-upload-area" id="imgUploadArea">
            <div class="img-preview-box" id="imgPreviewBox">üì¶</div>
            <div class="img-upload-info">
              <div class="img-upload-title">Upload foto produk</div>
              <div class="img-upload-sub">Format JPG, PNG, WEBP ¬∑ Rasio 1√ó1 disarankan ¬∑ Maks 2MB</div>
            </div>
            <label class="img-upload-btn">
              <svg width="13" height="13" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/></svg>
              Pilih Foto
              <input type="file" id="fImage" accept="image/*" style="display:none" onchange="handleImageUpload(event)">
            </label>
            <button class="img-remove-btn" onclick="removeImage(event)" title="Hapus foto">√ó</button>
          </div>
        </div>

        <div class="form-group full">
          <label class="form-label">Kategori (bisa pilih lebih dari satu)</label>
          <div class="tags-wrap">
            <label class="tag-check" data-tag="app"><input type="checkbox" value="app"> üì± App</label>
            <label class="tag-check" data-tag="populer"><input type="checkbox" value="populer"> üî• Populer</label>
            <label class="tag-check" data-tag="new"><input type="checkbox" value="new"> ‚ú® New</label>
            <label class="tag-check" data-tag="editing"><input type="checkbox" value="editing"> üé¨ Editing</label>
            <label class="tag-check" data-tag="movie"><input type="checkbox" value="movie"> üé• Movie</label>
            <label class="tag-check" data-tag="music"><input type="checkbox" value="music"> üéµ Music</label>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Badge</label>
          <select class="form-select" id="fBadge">
            <option value="">Tidak Ada</option>
            <option value="populer">üî• Populer</option>
            <option value="new">‚ú® New</option>
            <option value="best">üèÜ Best Seller</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">&nbsp;</label>
          <div style="padding:10px;background:var(--sky);border-radius:10px;font-size:12px;color:var(--primary);">
            üí° Badge akan muncul di pojok kanan atas kartu produk
          </div>
        </div>

      </div>

      <!-- PACKAGES -->
      <div style="margin-top:20px;">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;">
          <div class="form-label" style="margin:0;">Paket Layanan</div>
          <button class="btn btn-outline btn-sm" onclick="addPackage()">
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
            Tambah Paket
          </button>
        </div>
        <div class="package-list" id="packageList"></div>
      </div>
    </div>
    <div class="form-footer">
      <button class="btn btn-outline" onclick="closeModal()">Batal</button>
      <button class="btn btn-primary" onclick="saveProduct()">
        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
        Simpan Produk
      </button>
    </div>
  </div>
</div>

<!-- DELETE CONFIRM -->
<div class="modal-overlay" id="confirmOverlay">
  <div class="confirm-modal">
    <div class="confirm-icon">üóëÔ∏è</div>
    <div class="confirm-title">Hapus Produk?</div>
    <div class="confirm-msg" id="confirmMsg">Produk ini akan dihapus permanen dan tidak bisa dikembalikan.</div>
    <div class="confirm-btns">
      <button class="btn btn-outline" onclick="closeConfirm()">Batal</button>
      <button class="btn btn-danger" onclick="confirmDelete()">Ya, Hapus</button>
    </div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast">
  <span id="toastIcon">‚úì</span>
  <span id="toastMsg">Berhasil!</span>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ‚îÄ‚îÄ PASSWORD GATE ‚îÄ‚îÄ
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const ADMIN_PASSWORD = 'fazstore2026'; // ‚Üê GANTI SANDI DI SINI
const MAX_ATTEMPTS   = 5;
const LOCK_SECONDS   = 30;
const SESSION_KEY    = 'fazadmin_auth';

let gateAttempts = 0;
let lockTimer    = null;

function initGate() {
  // cek sesi aktif
  try {
    const sess = sessionStorage.getItem(SESSION_KEY);
    if (sess === 'ok') { unlockPanel(false); return; }
  } catch(e) {}
  // tunjukkan gate, blur konten
  document.getElementById('bodyContent').classList.add('blurred');
  document.getElementById('gateOverlay').classList.remove('hidden');
  setTimeout(() => document.getElementById('gateInput').focus(), 300);
}

function updateDots() {
  const val = document.getElementById('gateInput').value;
  const len = Math.min(val.length, 4);
  for (let i = 0; i < 4; i++) {
    document.getElementById('dot' + i).classList.toggle('filled', i < len);
  }
}

function toggleGateEye() {
  const inp  = document.getElementById('gateInput');
  const icon = document.getElementById('gateEyeIcon');
  if (inp.type === 'password') {
    inp.type = 'text';
    icon.innerHTML = `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"/>`;
  } else {
    inp.type = 'password';
    icon.innerHTML = `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>`;
  }
}

function checkPassword() {
  const val = document.getElementById('gateInput').value;
  const errEl = document.getElementById('gateError');

  if (!val) { errEl.textContent = 'Kata sandi tidak boleh kosong.'; return; }

  if (val === ADMIN_PASSWORD) {
    errEl.textContent = '';
    // simpan sesi
    try { sessionStorage.setItem(SESSION_KEY, 'ok'); } catch(e) {}
    unlockPanel(true);
  } else {
    gateAttempts++;
    document.getElementById('gateInput').classList.add('shake');
    setTimeout(() => document.getElementById('gateInput').classList.remove('shake'), 450);
    document.getElementById('gateInput').value = '';
    updateDots();

    const remaining = MAX_ATTEMPTS - gateAttempts;

    if (remaining <= 0) {
      startLockout();
    } else {
      errEl.textContent = 'Kata sandi salah!';
      const attEl = document.getElementById('gateAttempts');
      attEl.innerHTML = `Sisa percobaan: <span>${remaining}</span> dari ${MAX_ATTEMPTS}`;
    }
  }
}

function startLockout() {
  document.getElementById('gateNormal').style.display = 'none';
  document.getElementById('gateLocked').style.display = 'block';

  let secs = LOCK_SECONDS;
  document.getElementById('gateCountdown').textContent = secs;

  lockTimer = setInterval(() => {
    secs--;
    document.getElementById('gateCountdown').textContent = secs;
    if (secs <= 0) {
      clearInterval(lockTimer);
      gateAttempts = 0;
      document.getElementById('gateNormal').style.display = 'block';
      document.getElementById('gateLocked').style.display = 'none';
      document.getElementById('gateError').textContent = '';
      document.getElementById('gateAttempts').innerHTML = '';
      document.getElementById('gateInput').focus();
    }
  }, 1000);
}

function unlockPanel(animate) {
  const overlay = document.getElementById('gateOverlay');
  const body    = document.getElementById('bodyContent');

  if (animate) {
    overlay.style.transition = 'opacity 0.4s, transform 0.4s';
    overlay.style.opacity = '0';
    overlay.style.transform = 'scale(1.04)';
    setTimeout(() => {
      overlay.classList.add('hidden');
      overlay.style.opacity = '';
      overlay.style.transform = '';
    }, 400);
  } else {
    overlay.classList.add('hidden');
  }
  body.classList.remove('blurred');
}

function logout() {
  try { sessionStorage.removeItem(SESSION_KEY); } catch(e) {}
  gateAttempts = 0;
  document.getElementById('gateInput').value = '';
  document.getElementById('gateError').textContent = '';
  document.getElementById('gateAttempts').innerHTML = '';
  updateDots();
  document.getElementById('gateNormal').style.display = 'block';
  document.getElementById('gateLocked').style.display = 'none';
  document.getElementById('gateOverlay').classList.remove('hidden');
  document.getElementById('bodyContent').classList.add('blurred');
  setTimeout(() => document.getElementById('gateInput').focus(), 300);
}

// ‚îÄ‚îÄ DEFAULT PRODUCTS ‚îÄ‚îÄ
const DEFAULT_PRODUCTS = [
  { id:1, name:'Alight Motion', emoji:'üåÄ', tags:['app','populer','editing'], badge:'populer', badgeClass:'badge-pop', price:'Rp 3.000',
    packages:[{ name:'Alight Motion Sharing 1 Tahun', price:'Rp 3.000', features:['Garansi 6 bulan','Sharing 3U','Support All Device','Dilarang sebar data'] }] },
  { id:2, name:'Bstation', emoji:'üì∫', tags:['app','movie'], badge:null, price:'Rp 10.000',
    packages:[{ name:'Bstation Premium 1 Bulan', price:'Rp 10.000', features:['Akses Full Episode','No Ads','HD Quality','Garansi 1 bulan'] }] },
  { id:3, name:'Canva', emoji:'üé®', tags:['app','populer','editing'], badge:'populer', badgeClass:'badge-pop', price:'Rp 3.000',
    packages:[{ name:'Canva Pro Sharing 1 Bulan', price:'Rp 3.000', features:['Unlimited Template','Remove Background','Brand Kit','Magic AI Tools'] }] },
  { id:4, name:'CapCut', emoji:'‚úÇÔ∏è', tags:['app','editing'], badge:'best', badgeClass:'badge-best', price:'Rp 5.000',
    packages:[{ name:'CapCut Pro 1 Bulan', price:'Rp 5.000', features:['Semua Filter Premium','Auto Captions AI','Remove Watermark','1080P Export'] }] },
  { id:5, name:'ChatGPT', emoji:'ü§ñ', tags:['app','populer'], badge:'populer', badgeClass:'badge-pop', price:'Rp 15.000',
    packages:[{ name:'ChatGPT Plus Sharing 1 Bulan', price:'Rp 15.000', features:['GPT-4o Access','DALL¬∑E 3','Priority Speed','Advanced Analysis'] }] },
  { id:6, name:'Crunchyroll', emoji:'üçú', tags:['app','movie','new'], badge:'new', badgeClass:'badge-new', price:'Rp 10.000',
    packages:[{ name:'Crunchyroll Premium 1 Bulan', price:'Rp 10.000', features:['Anime Streaming','Simulcast Access','No Ads','HD Quality'] }] },
  { id:7, name:'iQIYI', emoji:'üéûÔ∏è', tags:['app','movie'], badge:null, price:'Rp 10.000',
    packages:[{ name:'iQIYI VIP 1 Bulan', price:'Rp 10.000', features:['Drama Korea & China','Full HD','Download Offline','No Ads'] }] },
  { id:8, name:'Lightroom', emoji:'üì∑', tags:['app','editing'], badge:null, price:'Rp 5.000',
    packages:[{ name:'Lightroom Premium 1 Bulan', price:'Rp 5.000', features:['Semua Preset','AI Masking','RAW Support','Cloud Sync'] }] },
  { id:9, name:'Meitu', emoji:'üíÑ', tags:['app','editing','new'], badge:'new', badgeClass:'badge-new', price:'Rp 10.000',
    packages:[{ name:'Meitu VIP 1 Bulan', price:'Rp 10.000', features:['AI Beauty Filter','AR Makeup','Template Premium','No Watermark'] }] },
  { id:10, name:'Prime Video', emoji:'üé¨', tags:['app','movie','new'], badge:'new', badgeClass:'badge-new', price:'Rp 8.000',
    packages:[{ name:'Prime Video 1 Bulan', price:'Rp 8.000', features:['Amazon Originals','4K UHD','Download Offline','Garansi 30 Hari'] }] },
  { id:11, name:'Spotify', emoji:'üéµ', tags:['app','music'], badge:null, price:'Rp 5.000',
    packages:[{ name:'Spotify Premium 1 Bulan', price:'Rp 5.000', features:['No Ads','Unlimited Skip','Download Offline','High Quality Audio'] }] },
  { id:12, name:'Netflix', emoji:'üé•', tags:['app','movie'], badge:null, price:'Rp 20.000',
    packages:[{ name:'Netflix Standard 1 Bulan', price:'Rp 20.000', features:['2 Screen','Full HD','Download Offline','Semua Konten'] }] },
];


// ‚îÄ‚îÄ STATE ‚îÄ‚îÄ
let products = [];
let editingId = null;
let deleteId = null;
let filterTag = 'all';
let searchQ = '';
let selectedImage = null; // base64 string or null (falls back to emoji)

// ‚îÄ‚îÄ STORAGE ‚îÄ‚îÄ
function saveToStorage() {
  try { localStorage.setItem('fazstore_products', JSON.stringify(products)); } catch(e) {}
}
function loadFromStorage() {
  try {
    const raw = localStorage.getItem('fazstore_products');
    if (raw) { products = JSON.parse(raw); return; }
  } catch(e) {}
  products = JSON.parse(JSON.stringify(DEFAULT_PRODUCTS));
  saveToStorage();
}

// ‚îÄ‚îÄ BADGE HELPERS ‚îÄ‚îÄ
function badgeClassFor(badge) {
  if (badge === 'populer') return 'badge-pop';
  if (badge === 'new') return 'badge-new';
  if (badge === 'best') return 'badge-best';
  return '';
}

// ‚îÄ‚îÄ RENDER TABLE ‚îÄ‚îÄ
function renderTable(q = searchQ, tag = filterTag) {
  searchQ = q; filterTag = tag;
  const body = document.getElementById('productTableBody');
  let list = products.filter(p => {
    const matchQ = p.name.toLowerCase().includes(q.toLowerCase());
    const matchTag = tag === 'all' || p.tags.includes(tag);
    return matchQ && matchTag;
  });

  if (list.length === 0) {
    body.innerHTML = `<tr><td colspan="6"><div class="empty-state">
      <div class="empty-icon">üì≠</div>
      <p>Tidak ada produk ditemukan</p>
    </div></td></tr>`;
    return;
  }

  body.innerHTML = list.map(p => {
    const tagBadges = p.tags.filter(t => t !== 'app').map(t => {
      const cls = t === 'populer' ? 'badge-yellow' : t === 'new' ? 'badge-green' : 'badge-blue';
      return `<span class="badge ${cls}">${t}</span>`;
    }).join(' ');

    let badgePill = '<span class="badge badge-gray">‚Äî</span>';
    if (p.badge === 'populer') badgePill = '<span class="badge badge-yellow">üî• Populer</span>';
    else if (p.badge === 'new') badgePill = '<span class="badge badge-green">‚ú® New</span>';
    else if (p.badge === 'best') badgePill = '<span class="badge badge-blue">üèÜ Best Seller</span>';

    return `<tr>
      <td>
        <div class="prod-cell">
          <div class="prod-emoji" style="${p.image ? 'padding:0;overflow:hidden;' : ''}">
            ${p.image
              ? `<img src="${p.image}" style="width:100%;height:100%;object-fit:cover;border-radius:10px;">`
              : (p.emoji || 'üì¶')}
          </div>
          <div>
            <div class="prod-name">${p.name}</div>
            <div class="prod-id">#${p.id}</div>
          </div>
        </div>
      </td>
      <td>${tagBadges || '<span class="badge badge-gray">app</span>'}</td>
      <td>${badgePill}</td>
      <td><span class="price-text">${p.price}</span></td>
      <td><span class="badge badge-blue">${p.packages.length} paket</span></td>
      <td>
        <div class="actions">
          <button class="btn btn-outline btn-sm" onclick="openEditModal(${p.id})">
            <svg width="13" height="13" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/></svg>
            Edit
          </button>
          <button class="btn btn-danger btn-sm" onclick="askDelete(${p.id})">
            <svg width="13" height="13" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
            Hapus
          </button>
        </div>
      </td>
    </tr>`;
  }).join('');

  updateStats();
}

function filterTable(val) {
  renderTable(searchQ, val);
}

function updateStats() {
  document.getElementById('statTotal').textContent   = products.length;
  document.getElementById('statPopuler').textContent = products.filter(p => p.badge === 'populer').length;
  document.getElementById('statNew').textContent     = products.filter(p => p.badge === 'new').length;
  document.getElementById('statBest').textContent    = products.filter(p => p.badge === 'best').length;
}

// ‚îÄ‚îÄ IMAGE UPLOAD ‚îÄ‚îÄ
function handleImageUpload(e) {
  const file = e.target.files[0];
  if (!file) return;
  if (file.size > 2 * 1024 * 1024) { showToast('Ukuran foto maks 2MB!', 'error'); return; }

  const reader = new FileReader();
  reader.onload = (ev) => {
    selectedImage = ev.target.result;
    const box = document.getElementById('imgPreviewBox');
    box.innerHTML = `<img src="${selectedImage}">`;
    document.getElementById('imgUploadArea').classList.add('has-image');
  };
  reader.readAsDataURL(file);
}

function removeImage(e) {
  e.stopPropagation();
  selectedImage = null;
  document.getElementById('imgPreviewBox').innerHTML = 'üì¶';
  document.getElementById('imgUploadArea').classList.remove('has-image');
  document.getElementById('fImage').value = '';
}

function resetImageUpload() {
  selectedImage = null;
  const box = document.getElementById('imgPreviewBox');
  if (box) { box.innerHTML = 'üì¶'; }
  document.getElementById('imgUploadArea')?.classList.remove('has-image');
  const fi = document.getElementById('fImage');
  if (fi) fi.value = '';
}

function setImagePreview(imageOrEmoji) {
  const box = document.getElementById('imgPreviewBox');
  const area = document.getElementById('imgUploadArea');
  if (!box || !area) return;
  if (imageOrEmoji && imageOrEmoji.startsWith('data:')) {
    selectedImage = imageOrEmoji;
    box.innerHTML = `<img src="${imageOrEmoji}">`;
    area.classList.add('has-image');
  } else {
    selectedImage = null;
    box.innerHTML = imageOrEmoji || 'üì¶';
    area.classList.remove('has-image');
  }
}

// ‚îÄ‚îÄ PACKAGES ‚îÄ‚îÄ
let pkgCounter = 0;
function addPackage(data = null) {
  const id = `pkg_${pkgCounter++}`;
  const list = document.getElementById('packageList');
  const featHtml = (data ? data.features : ['Garansi 1 bulan']).map((f, i) => featureRowHtml(id, i, f)).join('');

  const div = document.createElement('div');
  div.className = 'package-item';
  div.id = id;
  div.innerHTML = `
    <div class="package-item-head">
      <div class="package-item-title">Paket ${list.children.length + 1}</div>
      <button class="btn-remove-pkg" onclick="removePkg('${id}')">√ó</button>
    </div>
    <div class="pkg-grid">
      <div class="form-group">
        <div class="form-label">Nama Paket</div>
        <input class="form-input" id="${id}_name" placeholder="cth: Premium 1 Bulan" value="${data ? data.name : ''}">
      </div>
      <div class="form-group">
        <div class="form-label">Harga</div>
        <input class="form-input" id="${id}_price" placeholder="cth: Rp 15.000" value="${data ? data.price : ''}">
      </div>
    </div>
    <div class="form-label" style="margin-bottom:6px;">Fitur (opsional)</div>
    <div class="feature-list" id="${id}_feats">${featHtml}</div>
    <button class="btn-add-feat" onclick="addFeat('${id}')">
      <svg width="12" height="12" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M12 4v16m8-8H4"/></svg>
      Tambah Fitur
    </button>
  `;
  list.appendChild(div);
}

function featureRowHtml(pkgId, idx, val = '') {
  return `<div class="feature-row" id="${pkgId}_f${idx}">
    <input placeholder="cth: No Ads" value="${val}">
    <button class="btn-remove-feat" onclick="removeFeat('${pkgId}_f${idx}')">√ó</button>
  </div>`;
}

let featCounter = 0;
function addFeat(pkgId) {
  const container = document.getElementById(`${pkgId}_feats`);
  const id = `${pkgId}_f${featCounter++}`;
  const div = document.createElement('div');
  div.className = 'feature-row'; div.id = id;
  div.innerHTML = `<input placeholder="cth: No Ads"><button class="btn-remove-feat" onclick="removeFeat('${id}')">√ó</button>`;
  container.appendChild(div);
}

function removeFeat(id) { document.getElementById(id)?.remove(); }
function removePkg(id) { document.getElementById(id)?.remove(); }

function getPackagesFromForm() {
  const items = document.querySelectorAll('.package-item');
  return Array.from(items).map(item => {
    const id = item.id;
    const name  = document.getElementById(`${id}_name`)?.value.trim() || '';
    const price = document.getElementById(`${id}_price`)?.value.trim() || '';
    const featInputs = document.querySelectorAll(`#${id}_feats input`);
    const features = Array.from(featInputs).map(i => i.value.trim()).filter(Boolean);
    return { name, price, features };
  }).filter(p => p.name);
}

// ‚îÄ‚îÄ TAGS ‚îÄ‚îÄ
function getSelectedTags() {
  return Array.from(document.querySelectorAll('.tag-check input:checked')).map(i => i.value);
}
function setSelectedTags(tags) {
  document.querySelectorAll('.tag-check').forEach(label => {
    const tag = label.dataset.tag;
    const inp = label.querySelector('input');
    inp.checked = tags.includes(tag);
    label.classList.toggle('selected', tags.includes(tag));
  });
}

// ‚îÄ‚îÄ OPEN MODAL ‚îÄ‚îÄ
function openAddModal() {
  editingId = null;
  document.getElementById('modalTitle').textContent = 'Tambah Produk Baru';
  document.getElementById('fName').value = '';
  document.getElementById('fPrice').value = '';
  document.getElementById('fBadge').value = '';
  document.getElementById('packageList').innerHTML = '';
  pkgCounter = 0; featCounter = 0;
  resetImageUpload();
  setSelectedTags(['app']);
  addPackage();
  document.getElementById('modalOverlay').classList.add('open');
}

function openEditModal(id) {
  const p = products.find(x => x.id === id);
  if (!p) return;
  editingId = id;
  document.getElementById('modalTitle').textContent = `Edit: ${p.name}`;
  document.getElementById('fName').value  = p.name;
  document.getElementById('fPrice').value = p.price;
  document.getElementById('fBadge').value = p.badge || '';
  setSelectedTags(p.tags);
  document.getElementById('packageList').innerHTML = '';
  pkgCounter = 0; featCounter = 0;
  p.packages.forEach(pkg => addPackage(pkg));
  // restore image or emoji
  setImagePreview(p.image || p.emoji || 'üì¶');
  document.getElementById('modalOverlay').classList.add('open');
}

function closeModal() {
  document.getElementById('modalOverlay').classList.remove('open');
}

// ‚îÄ‚îÄ TAG CLICK ‚îÄ‚îÄ
document.querySelectorAll('.tag-check').forEach(label => {
  label.addEventListener('click', () => {
    const inp = label.querySelector('input');
    setTimeout(() => label.classList.toggle('selected', inp.checked), 0);
  });
});

// ‚îÄ‚îÄ SAVE ‚îÄ‚îÄ
function saveProduct() {
  const name  = document.getElementById('fName').value.trim();
  const price = document.getElementById('fPrice').value.trim();
  const badge = document.getElementById('fBadge').value;
  const tags  = getSelectedTags();
  const packages = getPackagesFromForm();

  if (!name) { showToast('Nama produk wajib diisi!', 'error'); return; }
  if (!price) { showToast('Harga wajib diisi!', 'error'); return; }
  if (packages.length === 0) { showToast('Minimal 1 paket layanan!', 'error'); return; }

  const finalTags = tags.length ? tags : ['app'];

  if (editingId) {
    const idx = products.findIndex(p => p.id === editingId);
    const existing = products[idx];
    products[idx] = {
      ...existing, name, price,
      image: selectedImage !== null ? selectedImage : existing.image,
      emoji: selectedImage ? null : (existing.emoji || 'üì¶'),
      badge: badge || null, badgeClass: badgeClassFor(badge), tags: finalTags, packages
    };
    showToast(`${name} berhasil diperbarui!`, 'success');
  } else {
    const newId = Math.max(0, ...products.map(p => p.id)) + 1;
    products.push({
      id: newId, name, price,
      image: selectedImage || null,
      emoji: selectedImage ? null : 'üì¶',
      badge: badge || null, badgeClass: badgeClassFor(badge), tags: finalTags, packages
    });
    showToast(`${name} berhasil ditambahkan!`, 'success');
  }

  saveToStorage();
  closeModal();
  renderTable();
}

// ‚îÄ‚îÄ DELETE ‚îÄ‚îÄ
function askDelete(id) {
  const p = products.find(x => x.id === id);
  deleteId = id;
  document.getElementById('confirmMsg').textContent = `Produk "${p?.name}" akan dihapus permanen.`;
  document.getElementById('confirmOverlay').classList.add('open');
}
function closeConfirm() {
  document.getElementById('confirmOverlay').classList.remove('open');
  deleteId = null;
}
function confirmDelete() {
  if (deleteId === null) return;
  const p = products.find(x => x.id === deleteId);
  products = products.filter(x => x.id !== deleteId);
  saveToStorage();
  closeConfirm();
  renderTable();
  showToast(`${p?.name} dihapus.`, 'error');
}

// ‚îÄ‚îÄ CLOSE OVERLAY ON OUTSIDE CLICK ‚îÄ‚îÄ
document.getElementById('modalOverlay').addEventListener('click', e => {
  if (e.target === e.currentTarget) closeModal();
});
document.getElementById('confirmOverlay').addEventListener('click', e => {
  if (e.target === e.currentTarget) closeConfirm();
});

// ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ
function showToast(msg, type = 'success') {
  const t = document.getElementById('toast');
  const icons = { success:'‚úì', error:'‚úï', info:'‚Ñπ' };
  document.getElementById('toastMsg').textContent = msg;
  document.getElementById('toastIcon').textContent = icons[type] || '‚úì';
  t.className = `toast ${type} show`;
  setTimeout(() => t.classList.remove('show'), 3000);
}

// ‚îÄ‚îÄ NAVIGATION ‚îÄ‚îÄ
function setPage(page) {
  document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
  event?.target?.closest('.sidebar-item')?.classList.add('active');
  if (page === 'add') { openAddModal(); }
}
function goToStore() {
  showToast('Membuka halaman toko...', 'info');
  setTimeout(() => window.open('marketplace.html', '_blank'), 500);
}

// ‚îÄ‚îÄ LOGO MANAGEMENT ‚îÄ‚îÄ
let pendingLogo = null;

function loadSavedLogo() {
  try {
    const logo = localStorage.getItem('fazstore_logo');
    if (logo) applyLogoToAdmin(logo);
  } catch(e) {}
}

function applyLogoToAdmin(src) {
  const el = document.querySelector('.sidebar-logo-icon');
  if (el) el.innerHTML = `<img src="${src}" alt="logo">`;
}

function openLogoModal() {
  pendingLogo = null;
  document.getElementById('logoSaveBtn').disabled = true;
  document.getElementById('logoStatus').textContent = '';
  document.getElementById('logoFileInput').value = '';

  // show current logo in preview
  try {
    const saved = localStorage.getItem('fazstore_logo');
    const prev = document.getElementById('logoPreview');
    if (saved) {
      prev.innerHTML = `<img src="${saved}">`;
    } else {
      prev.innerHTML = 'FS';
    }
  } catch(e) {}

  document.getElementById('logoModalOverlay').classList.add('open');
}

function closeLogoModal() {
  document.getElementById('logoModalOverlay').classList.remove('open');
  pendingLogo = null;
}

function handleLogoUpload(e) {
  const file = e.target.files[0];
  if (!file) return;
  if (file.size > 3 * 1024 * 1024) {
    document.getElementById('logoStatus').textContent = '‚ö†Ô∏è Ukuran file maks 3MB!';
    document.getElementById('logoStatus').style.color = 'var(--red)';
    return;
  }

  const reader = new FileReader();
  reader.onload = ev => {
    pendingLogo = ev.target.result;
    document.getElementById('logoPreview').innerHTML = `<img src="${pendingLogo}">`;
    document.getElementById('logoSaveBtn').disabled = false;
    document.getElementById('logoStatus').textContent = '‚úì Foto siap disimpan';
    document.getElementById('logoStatus').style.color = 'var(--green)';
  };
  reader.readAsDataURL(file);
}

function saveLogo() {
  if (!pendingLogo) return;
  try {
    localStorage.setItem('fazstore_logo', pendingLogo);
    applyLogoToAdmin(pendingLogo);
    showToast('Logo berhasil disimpan! Refresh toko untuk melihat perubahan.', 'success');
    closeLogoModal();
  } catch(e) {
    showToast('Gagal menyimpan logo. Coba foto yang lebih kecil.', 'error');
  }
}

function resetLogo() {
  try {
    localStorage.removeItem('fazstore_logo');
    const el = document.querySelector('.sidebar-logo-icon');
    if (el) el.innerHTML = 'FS';
    document.getElementById('logoPreview').innerHTML = 'FS';
    document.getElementById('logoSaveBtn').disabled = true;
    document.getElementById('logoStatus').textContent = 'Logo direset ke default.';
    document.getElementById('logoStatus').style.color = 'var(--text-muted)';
    showToast('Logo direset ke default.', 'info');
  } catch(e) {}
}

// close logo modal on outside click
document.getElementById('logoModalOverlay').addEventListener('click', e => {
  if (e.target === e.currentTarget) closeLogoModal();
});

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
loadFromStorage();
renderTable();
initGate();
loadSavedLogo();
</script>
</body>
</html>
